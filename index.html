<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="WeChat: shaojiang9650Email: shao_study@163.com">
<meta property="og:type" content="website">
<meta property="og:title" content="邵大宝的学习Blog">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="邵大宝的学习Blog">
<meta property="og:description" content="WeChat: shaojiang9650Email: shao_study@163.com">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Jiang Shao">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>邵大宝的学习Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">邵大宝的学习Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">最爱严小跳</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/23/Git/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Jiang Shao">
      <meta itemprop="description" content="WeChat: shaojiang9650<br>Email: shao_study@163.com">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="邵大宝的学习Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/23/Git/" class="post-title-link" itemprop="url">Git</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-06-23 18:16:26 / Modified: 20:13:43" itemprop="dateCreated datePublished" datetime="2022-06-23T18:16:26+08:00">2022-06-23</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%85%B6%E4%BB%96/" itemprop="url" rel="index"><span itemprop="name">其他</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Git"><a href="#Git" class="headerlink" title="Git"></a>Git</h1><h2 id="Git用户名和邮箱的配置"><a href="#Git用户名和邮箱的配置" class="headerlink" title="Git用户名和邮箱的配置"></a>Git用户名和邮箱的配置</h2><p>安装Git之后首先配置用户名和邮箱</p>
<blockquote>
<p>git config —global user.name “XXX”<br>git config —global user.email XXX</p>
</blockquote>
<p>—global表示全局设置，所有本地Git库使用相同的设置，如果希望在不同的项目中使用不同的配置，可在项目中配置并去掉—global符号。</p>
<blockquote>
<p>git config —list</p>
</blockquote>
<p>用于查看本地Git配置</p>
<h2 id="Git基本理论"><a href="#Git基本理论" class="headerlink" title="Git基本理论"></a>Git基本理论</h2><p>Git有三个本地工作区域：<br>1、工作目录（Working Directory）<br>2、暂存区（Stage/Index）<em>实际上是一个文件</em><br>3、资源库（Repository/Git Directory）<br>还有一个远程Git仓库（Remote Directory）<br>一共<strong>四个工作区域</strong></p>
<center><img src="/2022/06/23/Git/1.png" width="50%" height="50%"></center>
<center><font color="#708090" size="2">Two types of LDGSTS: access and bypass.</font></center>

<h3 id="提交改动"><a href="#提交改动" class="headerlink" title="提交改动"></a>提交改动</h3><p>1、在工作目录下，使用git add命令，将改动提交到暂存区，此时并未永久保存。<br>2、此时使用git commit命令，将暂存区的改动永久提交到本地仓库<br>3、使用git push命令，将本地仓库的改动提交到远程仓库</p>
<h3 id="从远程仓库获取"><a href="#从远程仓库获取" class="headerlink" title="从远程仓库获取"></a>从远程仓库获取</h3><p>1、使用git pull命令</p>
<h3 id="从本地仓库回滚"><a href="#从本地仓库回滚" class="headerlink" title="从本地仓库回滚"></a>从本地仓库回滚</h3><p>1、使用git reset命令，此命令从本地仓库将之前保存的版本回滚到暂存区</p>
<h3 id="从暂存区回滚到工作目录"><a href="#从暂存区回滚到工作目录" class="headerlink" title="从暂存区回滚到工作目录"></a>从暂存区回滚到工作目录</h3><p>1、使用git checkout命令，将暂存区中未提交的版本回滚到本地目录中</p>
<blockquote>
<ul>
<li><strong>Workspace</strong>：工作区，就是你平时存放<strong>项目代码</strong>的地方</li>
<li><strong>Index / Stage</strong>：暂存区，用于临时存放你的改动，事实上它<strong>只是一个文件</strong>，保存即将提交到文件列表信息</li>
<li><strong>Repository</strong>：仓库区（或本地仓库），就是<strong>安全存放数据</strong>的位置，这里面有你提交到所有版本的数据。其中<strong>HEAD指向最新放入仓库的版本</strong></li>
<li><strong>Remote</strong>：远程仓库，<strong>托管代码的服务器</strong>，可以简单的认为是你项目组中的一台电脑用于远程数据交换</li>
</ul>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/04/07/PC-Problem-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Jiang Shao">
      <meta itemprop="description" content="WeChat: shaojiang9650<br>Email: shao_study@163.com">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="邵大宝的学习Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/04/07/PC-Problem-2/" class="post-title-link" itemprop="url">Word中Mathtype公式变形问题</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-04-07 21:10:16" itemprop="dateCreated datePublished" datetime="2022-04-07T21:10:16+08:00">2022-04-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-04-20 15:05:09" itemprop="dateModified" datetime="2022-04-20T15:05:09+08:00">2022-04-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87%E5%A4%84%E7%90%86/" itemprop="url" rel="index"><span itemprop="name">计算机疑难杂症处理</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Word中Mathtype公式变形问题"><a href="#Word中Mathtype公式变形问题" class="headerlink" title="Word中Mathtype公式变形问题"></a>Word中Mathtype公式变形问题</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_34146849/article/details/116099673">关于word中插入的mathtype公式变形问题的解决方案</a></p>
<h2 id="单个公式解决方案"><a href="#单个公式解决方案" class="headerlink" title="单个公式解决方案"></a>单个公式解决方案</h2><ol>
<li>选中公式，右键，图片</li>
<li>大小选项卡，缩放，高度宽度设置为100 %，点击下方重新设置</li>
</ol>
<h2 id="批量解决方案"><a href="#批量解决方案" class="headerlink" title="批量解决方案"></a>批量解决方案</h2><ol>
<li>文件，选项，自定义功能区，启用开发工具</li>
<li>开发工具，Visual Basic，对应Project中右键，插入模块</li>
<li>添加代码<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> ResizeEquations()</span><br><span class="line">    <span class="keyword">For</span> <span class="keyword">Each</span> Field <span class="keyword">In</span> ActiveDocument.Fields</span><br><span class="line">        <span class="keyword">If</span> Trim(Field.Code) = <span class="string">&quot;EMBED Equation.DSMT4&quot;</span> <span class="keyword">Then</span></span><br><span class="line">            <span class="keyword">With</span> Field.InlineShape</span><br><span class="line">                .LockAspectRatio = msoFalse</span><br><span class="line">                .ScaleWidth = <span class="number">100</span></span><br><span class="line">                .ScaleHeight = <span class="number">100</span></span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    <span class="keyword">Next</span> Field</span><br><span class="line">    MsgBox (<span class="string">&quot;完成&quot;</span>) <span class="comment">&#x27;操作完成的提示框</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure></li>
<li>保存，另存为启用宏的文档</li>
<li>开发工具，宏，ResizeEquations，运行</li>
</ol>
<h2 id="Word里有设置的域，有些内容进行了手动修改，导出PDF后自动更新的解决方法"><a href="#Word里有设置的域，有些内容进行了手动修改，导出PDF后自动更新的解决方法" class="headerlink" title="Word里有设置的域，有些内容进行了手动修改，导出PDF后自动更新的解决方法"></a>Word里有设置的域，有些内容进行了手动修改，导出PDF后自动更新的解决方法</h2><p>Crtl+A  全选<br>Crtl+F11  锁定域<br>再导出PDF就不会自动更新了，点右键更新域也变成了灰色。<br>Ctrl + Shift + F11  解除锁定</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/03/01/PC-Problem-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Jiang Shao">
      <meta itemprop="description" content="WeChat: shaojiang9650<br>Email: shao_study@163.com">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="邵大宝的学习Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/03/01/PC-Problem-1/" class="post-title-link" itemprop="url">闲置状态下播放音频，音频延迟1s出现</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-03-01 14:26:03" itemprop="dateCreated datePublished" datetime="2022-03-01T14:26:03+08:00">2022-03-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-06-23 18:58:15" itemprop="dateModified" datetime="2022-06-23T18:58:15+08:00">2022-06-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87%E5%A4%84%E7%90%86/" itemprop="url" rel="index"><span itemprop="name">计算机疑难杂症处理</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="闲置状态下播放音频，音频延迟1s出现"><a href="#闲置状态下播放音频，音频延迟1s出现" class="headerlink" title="闲置状态下播放音频，音频延迟1s出现"></a>闲置状态下播放音频，音频延迟1s出现</h1><blockquote>
<p><strong>问题描述：</strong><br>惠普暗影精灵4插上耳机后，看视频暂停后在播放，会过几秒钟后才有声音。 </p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://zhidao.baidu.com/question/1452616740669491660.html">百度知道</a><br><a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/windows-hardware/drivers/audio/audio-device-class-inactivity-timer-implementation">微软官网: 音频设备类不活动计时器实现</a><br><a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/windows-hardware/drivers/kernel/device-power-states">微软官网: 设备电源状态</a></p>
<p>声音延迟是因为声卡驱动有一个省电管理，导致每一次暂停都会重启。</p>
<p>声音延迟2s的具体原因是Realtek的省电管理出现问题，为了节省电量Realtek在不工作时会自动关闭，导致每次启动Realtek时都需要重新加载，所以说会出现声音延迟1~2s的问题。解决思路是关闭Realtk的省电管理功能。具体解决方法是：</p>
<ul>
<li>使用windows+R键调出运行窗口，输入regedit打开注册表编辑器</li>
<li>按照路径寻找 HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Class\\{4d36e96c-e325-11ce-bfc1-08002be10318}\xxxx\PowerSettings</li>
<li>其中’xxxx’是个四位数字，不同型号的电脑数字可能不一样，在暗影精灵4 win10系统中’xxxx’即’0000’。验证方法为点击某个’xxxx’，右侧窗口的键值中有DriverDesc，若该DriverDesc的值为 ‘Realtk High Definition Audio’，则此’xxxx’就是我们要找的路径</li>
<li>找到PowerSettings中的三个二进制值并将它们修改为：<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ConservationIdleTime = ff ff ff ff <span class="comment">//电池供电下音频空闲等待时间最大</span></span><br><span class="line">IdlePowerState = <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="comment">//超出空闲等待时间后，设置电源状态为D0（完全）</span></span><br><span class="line">PerformanceIdleTime = ff ff ff ff <span class="comment">//电源供电下音频空闲等待时间最大</span></span><br></pre></td></tr></table></figure>
这些二进制值的默认值都是 00 00 00 00，有些其他的声卡驱动可能是0a 00 00 00</li>
<li><strong>重启电脑生效</strong>（重启资源管理器不行，必须重启电脑）</li>
</ul>
<p>这样就可以关闭Realtek省电管理。</p>
<p><strong>三个键值含义：</strong><br>注册表中的驱动程序根密钥：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Class\xxxx\yyyy</span><br></pre></td></tr></table></figure></p>
<ul>
<li><p>ConservationIdleTime</p>
<p>此参数指定系统在<strong>断电模式</strong>下运行时的空闲时间间隔。 这是系统<strong>以电池电源运行时</strong>通常使用的模式。 此参数的默认值为 0，这会在睡眠模式下禁用电源空闲计时器。 硬件供应商可以通过将 DWORD 值写入到以下特定于驱动程序的注册表项来替代默认值：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Class\xxxx\yyyy\PowerSettings\ConservationIdleTime</span><br></pre></td></tr></table></figure>
<p>请注意 ，xxxx 表示媒体类 GUID (请参阅 系统 提供的设备安装程序类) 和 yyyyy 表示媒体类 GUID 下的驱动程序子项的名称。 键的值指定<strong>以秒为单位</strong>的时间间隔。</p>
</li>
<li><p>PerformanceIdleTime</p>
<p>此参数指定系统在<strong>性能模式</strong>下运行时的空闲时间间隔。 这是系统<strong>在交流电源上运行时</strong>通常使用的模式。 此参数的默认值为 0，这会在性能模式下禁用电源空闲计时器。 硬件供应商可以通过将 DWORD 值写入到以下特定于驱动程序的注册表项来替代默认值：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Class\xxxx\yyyy\PowerSettings\PerformanceIdleTime</span><br></pre></td></tr></table></figure>
<p>同样 ，xxxx 表示 Media 类 GUID，yyyy 表示 驱动程序的子项的名称。 键的值指定<strong>以秒为单位</strong>的时间间隔。</p>
</li>
<li><p>IdlePowerState</p>
<p>此参数指定<strong>当空闲超时期限到期时设备将置于的电源状态</strong>。 此参数的默认值为 0，对应于设备电源状态 D0 (完全) 。 硬件供应商可以通过将 DWORD 值写入到以下特定于驱动程序的注册表项来替代默认值：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Class\xxxx\yyyy\PowerSettings\IdlePowerState</span><br></pre></td></tr></table></figure>
<p>同样 ，xxxx 表示 Media 类 GUID，yyyy 表示 驱动程序的子项的名称。 放置在键中的值应为 0、1、2 或 3，分别对应于设备电源状态 D0、D1、D2 或 D3。</p>
</li>
</ul>
<h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><p>例如，硬件供应商可能想要为音频设备指定以下电源空闲参数：为 Audio 设备指定 0x0000001e (30 秒) ，PerformanceIdleTime = 0x0000012c ( 300 秒) ，IdlePowerState = 0x00000003 (设备电源状态 D3) 。 若要启用这些设置，设备安装文件可以包含包含以下指令的 INF AddReg 节：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[MyAudioDevice.AddReg]</span><br><span class="line">HKR,PowerSettings,ConservationIdleTime,<span class="number">1</span>,<span class="number">1</span>e,<span class="number">00</span>,<span class="number">00</span>,<span class="number">00</span></span><br><span class="line">HKR,PowerSettings,PerformanceIdleTime,<span class="number">1</span>,<span class="number">2</span>c,<span class="number">01</span>,<span class="number">00</span>,<span class="number">00</span></span><br><span class="line">HKR,PowerSettings,IdlePowerState,<span class="number">1</span>,<span class="number">03</span>,<span class="number">00</span>,<span class="number">00</span>,<span class="number">00</span></span><br></pre></td></tr></table></figure><br>HKR 表示注册表中的驱动程序根密钥：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Class\xxxx\yyyy</span><br></pre></td></tr></table></figure><br>同样 ，xxxx 表示 Media 类 GUID，yyyy 表示 驱动程序的子项的名称。 PowerSettings子项是相对于根键的路径名称指定的。</p>
<center><img src="/2022/03/01/PC-Problem-1/1.png" width="100%"></center>

<p>改为</p>
<center><img src="/2022/03/01/PC-Problem-1/2.png" width="100%"></center>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/02/28/GAMES101-RayTracing-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Jiang Shao">
      <meta itemprop="description" content="WeChat: shaojiang9650<br>Email: shao_study@163.com">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="邵大宝的学习Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/02/28/GAMES101-RayTracing-2/" class="post-title-link" itemprop="url">GAMES101 RayTracing Part 2</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-02-28 17:21:15" itemprop="dateCreated datePublished" datetime="2022-02-28T17:21:15+08:00">2022-02-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-03-02 17:01:18" itemprop="dateModified" datetime="2022-03-02T17:01:18+08:00">2022-03-02</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/GAMES101-%E7%8E%B0%E4%BB%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6%E5%85%A5%E9%97%A8/" itemprop="url" rel="index"><span itemprop="name">GAMES101-现代计算机图形学入门</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="GAMES101-RayTracing-Part-2"><a href="#GAMES101-RayTracing-Part-2" class="headerlink" title="GAMES101 RayTracing Part 2"></a>GAMES101 RayTracing Part 2</h1><h2 id="Using-Axis-Aligned-Bounding-Boxes-AABBs-to-accelerate-ray-tracing"><a href="#Using-Axis-Aligned-Bounding-Boxes-AABBs-to-accelerate-ray-tracing" class="headerlink" title="Using Axis-Aligned Bounding Boxes (AABBs) to accelerate ray tracing"></a>Using Axis-Aligned Bounding Boxes (AABBs) to accelerate ray tracing</h2><h3 id="Uniform-Grids-均匀网格预处理"><a href="#Uniform-Grids-均匀网格预处理" class="headerlink" title="Uniform Grids 均匀网格预处理"></a>Uniform Grids 均匀网格预处理</h3><center><img src="/2022/02/28/GAMES101-RayTracing-2/1.png" width="100%"></center>

<ol>
<li>找到整个空间的包围盒</li>
<li>创建均匀网格</li>
<li>存储所有与空间中物体表面相交的单元</li>
</ol>
<center><img src="/2022/02/28/GAMES101-RayTracing-2/2.png" width="100%"></center>

<ol>
<li>从光线进入包围盒的第一个位置开始，逐个cell寻找与光线相交的cell（下一个cell一定是<strong>光线方向上的与当前cell相邻的cell</strong>，对于图中光线来说一定是当前cell的右侧cell或上方cell）</li>
<li>若当前cell中没有物体则继续下一个cell</li>
<li>若当前cell中存在物体则判断光线是否与cell中的物体相交</li>
</ol>
<p>对于均匀网格来说，cell数目太少不起作用，cell数目太多则用于判断cell与光线相交的计算太多。那么使用经验公式：3D中cell数目 = 场景中物体数目 * 27</p>
<center><img src="/2022/02/28/GAMES101-RayTracing-2/3.png" width="100%"></center>

<p>这种Uniform Grid方法适用于场景中<strong>存在大量物体</strong>，<strong>且物体均匀的分布在空间中</strong>的情况。</p>
<center><img src="/2022/02/28/GAMES101-RayTracing-2/4.png" width="100%"></center>

<h3 id="Spatial-Partitions-空间划分"><a href="#Spatial-Partitions-空间划分" class="headerlink" title="Spatial Partitions 空间划分"></a>Spatial Partitions 空间划分</h3><p>用于弥补uniform grids方法在物体空间分布稀疏情况下的不足。</p>
<center><img src="/2022/02/28/GAMES101-RayTracing-2/5.png" width="100%"></center>

<p><strong>八叉树</strong>：每个cell均匀分裂成8个子cell in 3D、4个子cell in 2D（对应树结构每个父节点具有8/4个子节点）<br><strong>KD树</strong>：每个cell沿着某一个轴切分为2个子cell（对应结构为二叉树），每次切分方向都在三个轴之间切换，保证切分空间的匀称性，使子cell接近立方体。<br><strong>BSP树</strong>：每次选一个特殊方向切分空间。由于axis-aligned有便于计算的特性，因此主要使用KD树。</p>
<center><img src="/2022/02/28/GAMES101-RayTracing-2/6.png" width="100%"></center>

<p><strong>KD-Tree 空间划分示意</strong><br>示例原因每次仅切分两个子节点中的一个，而实际情况下每个子节点都要进行切分，除非遇到递归基（满足一定条件无需继续切分）。</p>
<p><strong>Data Structure for KD-Trees</strong><br>Internal nodes store 内部节点</p>
<ul>
<li>split axis: x-, y-, or z-axis 切分方向每次在三个轴之间切换</li>
<li>split position: coordinate of split plane along axis 切分位置没有固定要求，一般沿着中间切分</li>
<li>children: pointers to child nodes 每个中间节点具有指向两个子节点的指针</li>
<li>No objects are stored in internal nodes 中间节点不存储场景中的物体信息<br>Leaf nodes store 叶节点（没有子节点）</li>
<li>list of objects 存储对应区域所包含的场景中的物体信息</li>
</ul>
<p><strong>KD-Tree查找交点示意</strong></p>
<center><img src="/2022/02/28/GAMES101-RayTracing-2/7.png" width="100%"></center>

<p>假设最终生成的KD-Tree就如图所示，对123节点并不继续划分，彩色的都是叶节点，对应图中一块区域。</p>
<center><img src="/2022/02/28/GAMES101-RayTracing-2/8.png" width="100%"></center>

<p>首先判断光线是否与根节点所对应的整个场景的最大的包围盒相交。如果相交那么遍历它的两个子节点，首先到节点1。</p>
<center><img src="/2022/02/28/GAMES101-RayTracing-2/9.png" width="100%"></center>

<p>首先判断是否与节点1所围成的<strong>包围盒相交</strong>，是则由于1是叶节点，那么遍历1中包含的所有物体，判断光线是否与<strong>物体相交</strong>。</p>
<center><img src="/2022/02/28/GAMES101-RayTracing-2/10.png" width="100%"></center>

<p>发现节点1中并无交点，转而判断节点B，发现与B的包围盒相交。而B是内部节点，那么继续判断B的子节点2。</p>
<center><img src="/2022/02/28/GAMES101-RayTracing-2/11.png" width="100%"></center>

<p>与节点2所围成的包围盒求交发现有交点，而节点2是一个叶节点，转而与节点2中包含的所有物体求交。发现没有，转而判断B的两一个子节点C。</p>
<center><img src="/2022/02/28/GAMES101-RayTracing-2/12.png" width="100%"></center>

<p>发现与C的包围盒有交点，继续判断C的子节点。由于子节点间并没有严格顺序。这里转而判断节点3。</p>
<center><img src="/2022/02/28/GAMES101-RayTracing-2/13.png" width="100%"></center>

<p>与3的包围盒求交-&gt;有交点。<br>3为叶节点-&gt;与3中所有物体求交-&gt;有交点-&gt;记录交点对应的 t_hit。<br><strong>此时转而判断C的另一个子节点D</strong>，再继续这个过程，找到所有的交点对应的 t_hit，永远记录一个为正的最小的 t，即为真实交点对应的 t。</p>
<center><img src="/2022/02/28/GAMES101-RayTracing-2/14.png" width="100%"></center>

<p>KD-Tree两个缺点：</p>
<ol>
<li>实际物体为三角形网格，很难判断一个三角形是否处于一个节点所对应的包围盒中。</li>
<li>同一个物体可能横跨了多个包围盒，被多个节点所记录。</li>
</ol>
<h3 id="Object-Partitions-物体划分-gt-Bounding-Volume-Hierarchy-BVH"><a href="#Object-Partitions-物体划分-gt-Bounding-Volume-Hierarchy-BVH" class="headerlink" title="Object Partitions 物体划分 -&gt; Bounding Volume Hierarchy (BVH)"></a>Object Partitions 物体划分 -&gt; Bounding Volume Hierarchy (BVH)</h3><p>把物体分为两堆（一个节点两个子节点），并重新计算这两堆物体的包围盒。</p>
<center>
<img src="/2022/02/28/GAMES101-RayTracing-2/15-1.png" width="100%">
<img src="/2022/02/28/GAMES101-RayTracing-2/15-2.png" width="100%">
<img src="/2022/02/28/GAMES101-RayTracing-2/15-3.png" width="100%">
<img src="/2022/02/28/GAMES101-RayTracing-2/15-4.png" width="100%">
</center>

<blockquote>
<p><strong>优点</strong>：</p>
<ol>
<li>场景中每个object只存储于一个叶节点中，不会被多个叶节点同时存储。</li>
<li>避免了KD-Tree中对子节点包围盒中所包含object的计算，直接利用分类后堆中的所有object求其包围盒。</li>
</ol>
</blockquote>
<p><strong>KD-Tree是对空间的划分</strong>，之后再把objects归类到相应的区域中。<strong>而BVH是对物体进行划分</strong>。</p>
<blockquote>
<p><strong>如何切分节点（将一堆objects划分为两堆）？</strong></p>
</blockquote>
<p>How to subdivide a node?</p>
<ul>
<li>Choose a dimension to split</li>
<li>Heuristic #1: Always choose the longest axis in node<br>选择节点最长的一个轴进行切分（空间切分），好处是切分之后两个子节点空间大小均匀。</li>
<li>Heuristic #2: Split node at location of median object<br>选择中间的物体进行切分（物体个数划分），好处是划分之后，两个子节点物体个数均匀，从而形成的二叉树较为平衡（二叉树深度较小，有利于缩短查找时间）。</li>
</ul>
<blockquote>
<p>选择物体进行切分时，需要找到第K个物体（Top K 问题），传统方法是对所有物体进行排序，时间复杂度O(nlogn)。而实际无需对所有节点都排序。<br><strong>基于快速排序的思维实现</strong>，时间复杂度为o(n)：</p>
<ol>
<li>选一个枢轴点（主元），用快排的方法将数组分为两部分，位于枢轴点左边的数都比它大，位于枢轴点右边的数都比它小。</li>
<li>划分后查看枢轴点索引值。如果恰好为k-1，则枢轴点即为第k大的数；否则若索引比k-1大，说明第k大的数位于左边部分；否则位于右边部分。</li>
<li>递归地再在左或右某一部分中选取一个主元，进行下一次划分。</li>
</ol>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/02/28/GAMES101-Geometry-Assignment4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Jiang Shao">
      <meta itemprop="description" content="WeChat: shaojiang9650<br>Email: shao_study@163.com">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="邵大宝的学习Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/02/28/GAMES101-Geometry-Assignment4/" class="post-title-link" itemprop="url">GAMES101 Geometry Assignment4</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-02-28 14:23:33 / Modified: 17:47:45" itemprop="dateCreated datePublished" datetime="2022-02-28T14:23:33+08:00">2022-02-28</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/GAMES101-%E7%8E%B0%E4%BB%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6%E5%85%A5%E9%97%A8/" itemprop="url" rel="index"><span itemprop="name">GAMES101-现代计算机图形学入门</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="GAMES101-Geometry-Assignment4"><a href="#GAMES101-Geometry-Assignment4" class="headerlink" title="GAMES101 Geometry Assignment4"></a>GAMES101 Geometry Assignment4</h1><h2 id="cv-Mat数据类型"><a href="#cv-Mat数据类型" class="headerlink" title="cv::Mat数据类型"></a>cv::Mat数据类型</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/czsnooker/article/details/118345494">OpenCV基础类型4—cv::Mat详解</a><br>cv::Mat是OpenCV定义的用于表示任意维度的稠密数组，OpenCV使用它来存储和传递图像。</p>
<p>由于cv::Mat要用于存储图像，它里面的元素可以是“像素”，对于像素，OpenCV定义了专门的数据格式来描述它们。<br>基本数据类型 + 通道数<br>CV_{8U, 16S, 16U, 32S, 32F, 64F}C{1, 2, 3}</p>
<p>数据类型前面的数字，对应数据类型的bit数。<br>8U:unsigned char;<br>16S: short int;<br>16U: unsigned short int;<br>32F: float;<br>64F: double.</p>
<p>{1，2，3}代表通道数。<br>彩色图像每个像素需要存储B、G、R（蓝、绿、红）3个信息，需要3个位置， 每一个称为一个“颜色通道”。<br>灰度图像无颜色，只有一个通道，故常为CV_8UC1。由黑到白。</p>
<p>作业中cv::Mat构造函数：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cv::Mat window = cv::<span class="built_in">Mat</span>(<span class="number">700</span>, <span class="number">700</span>, CV_8UC3, cv::<span class="built_in">Scalar</span>(<span class="number">0</span>));</span><br></pre></td></tr></table></figure><br>对应图像高（行数）700-row，宽（列数）700-col， 数据类型：CV_8UC3（unsigned char，彩色三通道），初始值为cv::Scalar(0)代表纯黑色。</p>
<p><strong>访问元素</strong><br>直接访问，使用模板函数at&lt;&gt;()</p>
<p>单通道, 尖括号里面的类型照着文章开头介绍的类型对应关系输入<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//这里数据类型为CV_32FC1，对应float，单通道，所以使用at&lt;float&gt;</span></span><br><span class="line">cv::Mat img = cv::Mat::<span class="built_in">ones</span>(<span class="number">240</span>, <span class="number">320</span>, CV_32FC1);</span><br><span class="line"><span class="type">float</span> elem = img.<span class="built_in">at</span>&lt;<span class="type">float</span>&gt;(<span class="number">10</span>, <span class="number">10</span>);</span><br></pre></td></tr></table></figure></p>
<p>多通道，Vec3b代表固定向量类。<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/czsnooker/article/details/118314514?spm=1001.2014.3001.5501">利用固定向量类访问</a><br>OpenCV中固定向量模板类cv::Vec&lt;&gt;别名命名规则：<br>cv::Vec{2,3,4,6}{b, s ,w , i, f, d}<br>{2,3,4,6}代表向量的长度。<br>{b, s ,w , i, f, d}表示向量内数据类型。分别对应：<br>b：unsigned char;<br>s：short int;<br>w：unsigned short;<br>i：int;<br>f：float;<br>d：double.</p>
<p>注意类型之间的对应，固定向量与Mat的代表字母有一点差异<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//cv::Mat元素类型CV_8UC3，对应unsigned char彩色三通道，因此使用固定向量类型cv::Vec3b，长度3向量，数据类型unsigned char</span></span><br><span class="line"><span class="function">cv::Mat <span class="title">img1</span><span class="params">(<span class="number">480</span>, <span class="number">640</span>, CV_8UC3, cv::Scalar(<span class="number">255</span>,<span class="number">255</span>,<span class="number">0</span>))</span></span>;</span><br><span class="line">cv::Vec3b elem = img1.<span class="built_in">at</span>&lt;cv::Vec3b&gt;(<span class="number">10</span>, <span class="number">10</span>);</span><br><span class="line">elem_B = elem[<span class="number">0</span>]; <span class="comment">//蓝色通道数值---255</span></span><br><span class="line">elem_G = elem[<span class="number">1</span>]; <span class="comment">//绿色通道数值---255</span></span><br><span class="line">elem_R = elem[<span class="number">2</span>]; <span class="comment">//红色通道---0</span></span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>要求你的实现将Bézier 曲线绘制为绿色。</p>
</blockquote>
<p>绿色对应RGB(0, 255, 0)。</p>
<h2 id="作业代码"><a href="#作业代码" class="headerlink" title="作业代码"></a>作业代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;chrono&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> t_step 0.001f</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CONTROL_POINTS_NUM 6</span></span><br><span class="line"></span><br><span class="line">std::vector&lt;cv::Point2f&gt; control_points;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mouse_handler</span><span class="params">(<span class="type">int</span> event, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> flags, <span class="type">void</span> *userdata)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (event == cv::EVENT_LBUTTONDOWN &amp;&amp; control_points.<span class="built_in">size</span>() &lt; CONTROL_POINTS_NUM) </span><br><span class="line">    &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;Left button of the mouse is clicked - position (&quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&quot;, &quot;</span></span><br><span class="line">        &lt;&lt; y &lt;&lt; <span class="string">&quot;)&quot;</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">        control_points.<span class="built_in">emplace_back</span>(x, y);</span><br><span class="line">    &#125;     </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">naive_bezier</span><span class="params">(<span class="type">const</span> std::vector&lt;cv::Point2f&gt; &amp;points, cv::Mat &amp;window)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> &amp;p_0 = points[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">auto</span> &amp;p_1 = points[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">auto</span> &amp;p_2 = points[<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">auto</span> &amp;p_3 = points[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">double</span> t = <span class="number">0.0</span>; t &lt;= <span class="number">1.0</span>; t += <span class="number">0.001</span>) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> point = std::<span class="built_in">pow</span>(<span class="number">1</span> - t, <span class="number">3</span>) * p_0 + <span class="number">3</span> * t * std::<span class="built_in">pow</span>(<span class="number">1</span> - t, <span class="number">2</span>) * p_1 +</span><br><span class="line">                 <span class="number">3</span> * std::<span class="built_in">pow</span>(t, <span class="number">2</span>) * (<span class="number">1</span> - t) * p_2 + std::<span class="built_in">pow</span>(t, <span class="number">3</span>) * p_3;</span><br><span class="line"></span><br><span class="line">        window.<span class="built_in">at</span>&lt;cv::Vec3b&gt;(point.y, point.x)[<span class="number">2</span>] = <span class="number">255</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//计算阶乘</span></span><br><span class="line"><span class="function"><span class="type">float</span> <span class="title">Factorial</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1.0f</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">float</span> result = <span class="number">1.0f</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">size_t</span> i = n; i &gt; <span class="number">0</span>; i--)</span><br><span class="line">        &#123;</span><br><span class="line">            result *= i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">cv::Point2f <span class="title">recursive_bezier</span><span class="params">(<span class="type">const</span> std::vector&lt;cv::Point2f&gt; &amp;control_points, <span class="type">float</span> t)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> Implement de Casteljau&#x27;s algorithm</span></span><br><span class="line">    <span class="function">cv::Point2f <span class="title">point_</span><span class="params">(<span class="number">0.f</span>, <span class="number">0.f</span>)</span></span>;</span><br><span class="line">    <span class="type">int</span> n = control_points.<span class="built_in">size</span>() - <span class="number">1</span>;<span class="comment">//贝塞尔曲线阶数为控制点个数-1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; n + <span class="number">1</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//伯恩斯坦多项式</span></span><br><span class="line">        <span class="type">float</span> Bni = <span class="built_in">Factorial</span>(n) / <span class="built_in">Factorial</span>(i) / <span class="built_in">Factorial</span>(n - i) * <span class="built_in">powf</span>(t, i) * <span class="built_in">pow</span>(<span class="number">1</span> - t, n - i);</span><br><span class="line">        <span class="comment">//std::cout &lt;&lt; Bni &lt;&lt; std::endl;</span></span><br><span class="line">        point_ += Bni * control_points[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> point_;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bezier</span><span class="params">(<span class="type">const</span> std::vector&lt;cv::Point2f&gt; &amp;control_points, cv::Mat &amp;window)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> Iterate through all t = 0 to t = 1 with small steps, and call de Casteljau&#x27;s </span></span><br><span class="line">    <span class="comment">// recursive Bezier algorithm.</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">float</span> t = <span class="number">0</span>; t &lt; <span class="number">1</span>; t+=t_step)</span><br><span class="line">    &#123;</span><br><span class="line">        cv::Point2f point_ = <span class="built_in">recursive_bezier</span>(control_points, t);</span><br><span class="line">        window.<span class="built_in">at</span>&lt;cv::Vec3b&gt;(point_.y, point_.x)[<span class="number">1</span>] = <span class="number">255</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cv::Mat window = cv::<span class="built_in">Mat</span>(<span class="number">700</span>, <span class="number">700</span>, CV_8UC3, cv::<span class="built_in">Scalar</span>(<span class="number">0</span>));<span class="comment">//黑色屏幕</span></span><br><span class="line">    <span class="comment">//cv::Mat window = cv::Mat(700, 700, CV_8UC3, cv::Scalar(0,255,0));//绿色屏幕</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    cv::<span class="built_in">cvtColor</span>(window, window, cv::COLOR_BGR2RGB);</span><br><span class="line">    cv::<span class="built_in">namedWindow</span>(<span class="string">&quot;Bezier Curve&quot;</span>, cv::WINDOW_AUTOSIZE);</span><br><span class="line"></span><br><span class="line">    cv::<span class="built_in">setMouseCallback</span>(<span class="string">&quot;Bezier Curve&quot;</span>, mouse_handler, <span class="literal">nullptr</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> key = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span> (key != <span class="number">27</span>) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;point : control_points) </span><br><span class="line">        &#123;</span><br><span class="line">            cv::<span class="built_in">circle</span>(window, point, <span class="number">3</span>, &#123;<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>&#125;, <span class="number">3</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (control_points.<span class="built_in">size</span>() == CONTROL_POINTS_NUM) </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//naive_bezier(control_points, window);</span></span><br><span class="line">            <span class="built_in">bezier</span>(control_points, window);</span><br><span class="line"></span><br><span class="line">            cv::<span class="built_in">imshow</span>(<span class="string">&quot;Bezier Curve&quot;</span>, window);</span><br><span class="line">            cv::<span class="built_in">imwrite</span>(<span class="string">&quot;my_bezier_curve.png&quot;</span>, window);</span><br><span class="line">            key = cv::<span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        cv::<span class="built_in">imshow</span>(<span class="string">&quot;Bezier Curve&quot;</span>, window);</span><br><span class="line">        key = cv::<span class="built_in">waitKey</span>(<span class="number">20</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/02/25/GAMES101-Geometry-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Jiang Shao">
      <meta itemprop="description" content="WeChat: shaojiang9650<br>Email: shao_study@163.com">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="邵大宝的学习Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/02/25/GAMES101-Geometry-1/" class="post-title-link" itemprop="url">GAMES101 Geometry part1</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-02-25 17:05:59" itemprop="dateCreated datePublished" datetime="2022-02-25T17:05:59+08:00">2022-02-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-02-28 14:24:03" itemprop="dateModified" datetime="2022-02-28T14:24:03+08:00">2022-02-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/GAMES101-%E7%8E%B0%E4%BB%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6%E5%85%A5%E9%97%A8/" itemprop="url" rel="index"><span itemprop="name">GAMES101-现代计算机图形学入门</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="GAMES101-Geometry-part1"><a href="#GAMES101-Geometry-part1" class="headerlink" title="GAMES101 Geometry part1"></a>GAMES101 Geometry part1</h1><p><strong>表示几何形状的方式：</strong></p>
<p>隐式表示：</p>
<ol>
<li>algebraic surface 代数曲面</li>
<li>level set 水平集</li>
<li>distance functions 距离函数</li>
<li>…</li>
</ol>
<p>显式表示：</p>
<ol>
<li>point cloud 点云</li>
<li>polygon mesh 多边形网格</li>
<li>subdivision, NURBS 样条曲线</li>
<li>…</li>
</ol>
<p><strong>隐式表示</strong>基于对点的划分。所有的点满足特定的关系。<br>缺点：Sampling Can Be Hard，由于只知道点所满足的关系，因此想要知道组成几何的点比较困难。<br>优点：Inside/Outside Tests Easy，判断空间中一个点是否在曲面内很容易，直接代入到几何的约束关系中。</p>
<p><strong>显示表示</strong>是直接给出所有组成几何的点，或者依据参数映射给出所有点。<br>优点：Sampling Is Easy<br>缺点：Inside/Outside Test Hard</p>
<h2 id="Implicit-Representations-in-Computer-Graphics-计算机图形学中几何的隐式表示方法"><a href="#Implicit-Representations-in-Computer-Graphics-计算机图形学中几何的隐式表示方法" class="headerlink" title="Implicit Representations in Computer Graphics 计算机图形学中几何的隐式表示方法"></a>Implicit Representations in Computer Graphics 计算机图形学中几何的隐式表示方法</h2><h3 id="Algebraic-Surfaces-Implicit-代数表面"><a href="#Algebraic-Surfaces-Implicit-代数表面" class="headerlink" title="Algebraic Surfaces (Implicit) 代数表面"></a>Algebraic Surfaces (Implicit) 代数表面</h3><p>Surface is zero set of a polynomial in x, y, z.<br>表面为多项式的零集。（使得一个多项式等于0的所有值的集合）</p>
<p>${ {x}^{2} }+{ {y}^{2} }+{ {z}^{2} }-1=0$<br>${ {\left( R-\sqrt{ { {x}^{2} }+{ {y}^{2} } } \right)}^{2} }+{ {z}^{2} }-{ {r}^{2} }=0$<br>${ {\left( { {x}^{2} }+\frac{9}{4}{ {y}^{2} }+{ {z}^{2} }-1 \right)}^{3} }-{ {x}^{2} }{ {z}^{3} }-\frac{9}{80}{ {y}^{2} }{ {z}^{3} }=0$</p>
<center><img src="/2022/02/25/GAMES101-Geometry-1/1.png" width="100%" height="100%"></center>

<h3 id="Constructive-Solid-Geometry-Implicit-构造实体几何"><a href="#Constructive-Solid-Geometry-Implicit-构造实体几何" class="headerlink" title="Constructive Solid Geometry (Implicit) 构造实体几何"></a>Constructive Solid Geometry (Implicit) 构造实体几何</h3><p>Combine implicit geometry via Boolean operations.<br>通过布尔运算构造几何。并集、交集、差集</p>
<center><img src="/2022/02/25/GAMES101-Geometry-1/2.png" width="100%" height="100%"></center>

<h3 id="Distance-Functions-Implicit-距离函数"><a href="#Distance-Functions-Implicit-距离函数" class="headerlink" title="Distance Functions (Implicit) 距离函数"></a>Distance Functions (Implicit) 距离函数</h3><p>Gradually blend surfaces together using Distance functions. 使用距离函数逐渐混合表面。</p>
<center><img src="/2022/02/25/GAMES101-Geometry-1/3.png" width="100%" height="100%"><img src="/2022/02/25/GAMES101-Geometry-1/3_1.png" width="100%" height="100%"></center>

<p><strong>Distance functions: 距离函数</strong><br>giving minimum distance (could be signed distance)<br>from anywhere to object.<br>给出任意位置到物体的最小距离（垂直于表面），可以是有符号的距离，为负代表在物体内部。</p>
<center><img src="/2022/02/25/GAMES101-Geometry-1/4.png" width="100%" height="100%"></center>

<p>逐渐混合的原理是，如图例所示，对于区域中一个边界来说，边界左侧为负（视为边界内部）右侧为正（视为边界外部）。<strong>SDF为0代表边界</strong>，图AB正负所占区域各不相同，blend之后相当于对AB中边界的一个线性插值（对0的位置的插值）。</p>
<h3 id="Level-Set-Methods-implicit-水平集"><a href="#Level-Set-Methods-implicit-水平集" class="headerlink" title="Level Set Methods (implicit) 水平集"></a>Level Set Methods (implicit) 水平集</h3><p>对于复杂形状来说，描述边界的方程很难得到，因此对空间进行采样，给出空间中各个点的距离值。这样边界就可以通过插值方式得到（距离为0的地方）。</p>
<center><img src="/2022/02/25/GAMES101-Geometry-1/5.png" width="100%" height="100%"></center>

<h3 id="Fractals-Implicit-分形"><a href="#Fractals-Implicit-分形" class="headerlink" title="Fractals (Implicit) 分形"></a>Fractals (Implicit) 分形</h3><p>Exhibit self-similarity, detail at all scales.<br>自相似特性 </p>
<h3 id="隐式描述几何形状的优缺点"><a href="#隐式描述几何形状的优缺点" class="headerlink" title="隐式描述几何形状的优缺点"></a>隐式描述几何形状的优缺点</h3><p>优点：</p>
<ol>
<li>紧凑的表示方法（比如一个函数）</li>
<li>对于特定的查询非常方便（比如在物体内外、点到边界的距离）</li>
<li>方便表面与光线求交点</li>
<li>对于一些简单形状，描述准确、无采样误差</li>
<li>易于处理拓扑结构的变化（比如流体：拓扑结构多变且多样）</li>
</ol>
<p>缺点：</p>
<ol>
<li>对复杂形状来说隐式描述相对困难</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/02/25/GAMES101-Geometry-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Jiang Shao">
      <meta itemprop="description" content="WeChat: shaojiang9650<br>Email: shao_study@163.com">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="邵大宝的学习Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/02/25/GAMES101-Geometry-2/" class="post-title-link" itemprop="url">GAMES101 Geometry part2</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-02-25 17:03:43" itemprop="dateCreated datePublished" datetime="2022-02-25T17:03:43+08:00">2022-02-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-02-28 14:24:13" itemprop="dateModified" datetime="2022-02-28T14:24:13+08:00">2022-02-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/GAMES101-%E7%8E%B0%E4%BB%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6%E5%85%A5%E9%97%A8/" itemprop="url" rel="index"><span itemprop="name">GAMES101-现代计算机图形学入门</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="GAMES101-Geometry-part2"><a href="#GAMES101-Geometry-part2" class="headerlink" title="GAMES101 Geometry part2"></a>GAMES101 Geometry part2</h1><h2 id="Explicit-Representations-in-Computer-Graphics-计算机图形学中几何的显式表示方法"><a href="#Explicit-Representations-in-Computer-Graphics-计算机图形学中几何的显式表示方法" class="headerlink" title="Explicit Representations in Computer Graphics 计算机图形学中几何的显式表示方法"></a>Explicit Representations in Computer Graphics 计算机图形学中几何的显式表示方法</h2><p><strong>Curves</strong></p>
<ul>
<li>Bezier curves 贝塞尔曲线<br>— De Casteljau’s algorithm 德卡斯特里奥算法</li>
<li>B-splines, etc. B样条曲线</li>
</ul>
<p><strong>Surfaces</strong></p>
<ul>
<li>Bezier surfaces 贝塞尔曲面</li>
<li>Triangles &amp; quads 三角形网格与四边形网格<br>— Subdivision, simplification, regularization 细化，粗化，正则化</li>
</ul>
<h3 id="Point-Cloud-Explicit-点云"><a href="#Point-Cloud-Explicit-点云" class="headerlink" title="Point Cloud (Explicit) 点云"></a>Point Cloud (Explicit) 点云</h3><ol>
<li>Easiest representation: list of points (x,y,z)<br>最简单的表示方法，点列表</li>
<li>Easily represent any kind of geometry<br>很容易表示任何形状</li>
<li>Useful for LARGE datasets (&gt;&gt;1 point/pixel)<br>适用于于大型数据集，每个像素都有远大于1个点</li>
<li>Often converted into polygon mesh<br>经常被转化为多边形网络</li>
<li>Difficult to draw in undersampled regions<br>对采样不足的区域很难绘制（指点比较稀疏的区域，每个像素包含的点太少、甚至可能没有）</li>
</ol>
<center><img src="/2022/02/25/GAMES101-Geometry-2/1.png" width="50%" height="50%"></center>

<h3 id="Polygon-Mesh-Explicit-多边形网络"><a href="#Polygon-Mesh-Explicit-多边形网络" class="headerlink" title="Polygon Mesh (Explicit) 多边形网络"></a>Polygon Mesh (Explicit) 多边形网络</h3><ol>
<li>Store vertices &amp; polygons (often triangles or quads)<br>存储顶点和多边形（三角形、四边形居多）</li>
<li>Easier to do processing / simulation, adaptive sampling<br>易于处理、模拟、自适应采样</li>
<li>More complicated data structures<br>更复杂的数据结构</li>
<li>Perhaps most common representation in graphics<br>图形学中目前最常用的表示方法</li>
</ol>
<center><img src="/2022/02/25/GAMES101-Geometry-2/2.png" width="100%" height="100%"></center>

<h4 id="The-Wavefront-Object-File-obj-Format"><a href="#The-Wavefront-Object-File-obj-Format" class="headerlink" title="The Wavefront Object File (.obj) Format"></a>The Wavefront Object File (.obj) Format</h4><p>描述多边形网格的文件格式。<br>Commonly used in Graphics research.<br>Just a text file that specifies vertices, normals, texture<br>coordinates and their connectivities.<br>是一个txt文件，指定了多边形网络的<strong>顶点</strong>、<strong>法线</strong>、<strong>纹理坐标</strong>与<strong>顶点之间的连接关系</strong>。</p>
<center><img src="/2022/02/25/GAMES101-Geometry-2/3.png" width="100%" height="100%"></center>

<p>文件中：<br>v代表vertices顶点坐标<br>vt代表各个顶点对应的纹理坐标<br>vn代表各个顶点对应的法线方向<br>f则代表face，指顶点之间的连接方式从而组成一个面，格式为v/vt/vn</p>
<h3 id="Bezier-Curves-贝塞尔曲线"><a href="#Bezier-Curves-贝塞尔曲线" class="headerlink" title="Bézier Curves 贝塞尔曲线"></a>Bézier Curves 贝塞尔曲线</h3><p>Defining Cubic Bézier Curve With Tangents<br>使用切线定义三次贝塞尔曲线</p>
<center><img src="/2022/02/25/GAMES101-Geometry-2/4.png" width="70%" height="70%"></center>

<p>P为一系列控制点，用于定义曲线。指明了曲线要满足的一些性质。</p>
<ol>
<li>曲线由P0开始，到P3结束</li>
<li>在P0处曲线沿着P0P1为切线，切线长度为t0</li>
<li>在P3处曲线沿着P2P3为切线，切线程度为t1</li>
</ol>
<h4 id="de-Casteljau-Algorithm"><a href="#de-Casteljau-Algorithm" class="headerlink" title="de Casteljau Algorithm"></a>de Casteljau Algorithm</h4><p>用于绘制贝塞尔曲线</p>
<p>Consider three points (quadratic Bezier)<br>考虑三个控制点的情况（二次贝塞尔曲线）</p>
<center><img src="/2022/02/25/GAMES101-Geometry-2/5_1.png" width="50%"><img src="/2022/02/25/GAMES101-Geometry-2/5_2.png" width="50%"></center>

<p>三次线性插值，根据同一个t得到对应位置。<br>$b_{0}^{1}={ {b}_{0} }+({ {b}_{1} }-{ {b}_{0} })<em>t$<br>$b_{1}^{1}={ {b}_{1} }+({ {b}_{2} }-{ {b}_{1} })</em>t$<br>$b_{0}^{2}=b_{0}^{1}+(b_{1}^{1}-b_{0}^{1})*t$</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45333934/article/details/108274320">公式渲染错误：Nunjucks Error 解决方案</a></p>
<script type="math/tex; mode=display">b_{0}^{2}={ {(1-t)}^{2} }{ {b}_{0} }+2t(1-t){ {b}_{1} }+{ {t}^{2} }{ {b}_{2} }</script><p>Four input points in total (Cubic Bézier Curve)<br>相同的递归线性插值</p>
<center><img src="/2022/02/25/GAMES101-Geometry-2/9.png" width="90%"></center>

<center><img src="/2022/02/25/GAMES101-Geometry-2/6.png" width="100%"></center>
<center><img src="/2022/02/25/GAMES101-Geometry-2/7.png" width="50%"><img src="/2022/02/25/GAMES101-Geometry-2/7_2.png" width="50%"></center>

<p><strong>通用贝塞尔曲线公式</strong><br><strong>Bernstein polynomial 伯恩斯坦多项式</strong></p>
<center><img src="/2022/02/25/GAMES101-Geometry-2/8.png" width="50%"></center>

<script type="math/tex; mode=display">\left( \begin{align}
  & n \nonumber \\
 & i \nonumber \\
\end{align} \right)=\frac{n!}{i!(n-i)!}</script><p><strong>Bernstein form of a Bézier curve of order n:</strong><br><strong>n阶贝塞尔曲线伯恩斯坦形式（n+1个控制点）：</strong></p>
<script type="math/tex; mode=display">{ {b}^{n} }(t)=\sum\limits_{i=0}^{n}{ { {b}_{i} }B_{i}^{n}(t)}</script><center><img src="/2022/02/25/GAMES101-Geometry-2/11.png" width="50%"></center>
伯恩斯坦多项式在t的任何位置，各个多项式的和都为1，是对所有控制点的线性插值。可以看到在t=0和1的位置，多项式其他项都是0，只有首项/末项为1，对应插值结果为首个/最后一个控制点。

#### Properties of Bézier Curves 贝塞尔曲线特性

1. Interpolates endpoints 插值端点
   曲线端点为首末控制点，对于3次贝塞尔曲线，曲线端点为b0, b3
2. Tangent to end segments 
   曲线在首末位置正切于控制点组成的线段，同上${b}'(0)=3({ {b}_{1} }-{ {b}_{0} })$, ${b}'(1)=3({ {b}_{3} }-{ {b}_{2} })$括号中为插值变量t。系数3只是因为三阶曲线有四个控制点，其他阶数并不严格是3。
3. Affine transformation property 
   Transform curve by transforming control points
   对控制点进行仿射变换，再使用变换后的控制点绘制贝塞尔曲线，与直接对贝塞尔曲线进行仿射变换等效。（仅对仿射变换有效，对投影等变换无效）
4. Convex hull property 凸包性质
   Curve is within convex hull of control points
   贝塞尔曲线一定在控制点所围成的凸包内（凸包，板上钉钉子，用个橡皮筋围一下，都是凸角）
<center><img src="/2022/02/25/GAMES101-Geometry-2/12.png" width="50%"></center>
<center><font color="#708090" size="2">10阶贝塞尔曲线，11个控制点。</font></center>

<h4 id="Piecewise-Bezier-Curves-分段贝塞尔曲线"><a href="#Piecewise-Bezier-Curves-分段贝塞尔曲线" class="headerlink" title="Piecewise Bézier Curves 分段贝塞尔曲线"></a>Piecewise Bézier Curves 分段贝塞尔曲线</h4><p>对于高阶贝塞尔曲线来说，要控制曲线的形状非常困难，控制点之间都是互相耦合的。因此要实现一个较长的贝塞尔曲线，可以将低阶的贝塞尔曲线连接起来实现 -&gt; Piecewise Bézier Curves。</p>
<center><img src="/2022/02/25/GAMES101-Geometry-2/13.png" width="50%"></center>
<center><font color="#708090" size="2">Piecewise Bézier Curves.</font></center>

<p>逐段贝塞尔曲线：每四个控制点，定义一段三阶贝塞尔曲线。对于图中第一段来说，控制点为1234，曲线起止与14控制点。</p>
<h5 id="Piecewise-Bezier-Curve-–-Continuity-连续性"><a href="#Piecewise-Bezier-Curve-–-Continuity-连续性" class="headerlink" title="Piecewise Bézier Curve – Continuity 连续性"></a>Piecewise Bézier Curve – Continuity 连续性</h5><p>如何使两端曲线连接处光滑，起止点连接（值连续），起止点处切线方向一致，且切线大小相同（导数连续）。</p>
<p><strong>C0连续</strong>：起止点连接</p>
<center><img src="/2022/02/25/GAMES101-Geometry-2/14.png" width="100%"></center>

<p><strong>C1连续</strong>：切线连续，两端切线方向相反，长度相同。</p>
<center><img src="/2022/02/25/GAMES101-Geometry-2/15.png" width="100%"></center>

<h3 id="Bezier-Surfaces-贝塞尔曲面"><a href="#Bezier-Surfaces-贝塞尔曲面" class="headerlink" title="Bézier Surfaces 贝塞尔曲面"></a>Bézier Surfaces 贝塞尔曲面</h3><center><img src="/2022/02/25/GAMES101-Geometry-2/16.png" width="100%"></center>
<center><font color="#708090" size="2">Bicubic Bézier Surface Patch.</font></center>

<p>通过双线性插值方法得到，双三次贝塞尔曲面，一共4*4个控制点。</p>
<ol>
<li>每行拿出四个控制点，在所有时间u上插值，得到一条贝塞尔曲线。</li>
<li>在每个时间u，又能在对应四条贝塞尔曲线上得到四个曲线上的点。</li>
<li>在每个时间u，以这四个点为控制点，在所有时间v上插值，又能画出一条贝塞尔曲线，则不同时间u的这条曲线构成了一个贝塞尔曲面。</li>
<li>对应两个插值时间(u, v)，这两个参数可以映射到曲面上的每个点，参数映射-&gt;所以贝塞尔曲面是显示表示方法。</li>
</ol>
<center><img src="/2022/02/25/GAMES101-Geometry-2/17.png" width="100%"></center>
<center><img src="/2022/02/25/GAMES101-Geometry-2/18.png" width="100%"></center>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/02/25/GAMES101-Geometry-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Jiang Shao">
      <meta itemprop="description" content="WeChat: shaojiang9650<br>Email: shao_study@163.com">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="邵大宝的学习Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/02/25/GAMES101-Geometry-3/" class="post-title-link" itemprop="url">GAMES101 Geometry part3</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-02-25 17:02:43" itemprop="dateCreated datePublished" datetime="2022-02-25T17:02:43+08:00">2022-02-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-02-28 17:01:37" itemprop="dateModified" datetime="2022-02-28T17:01:37+08:00">2022-02-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/GAMES101-%E7%8E%B0%E4%BB%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6%E5%85%A5%E9%97%A8/" itemprop="url" rel="index"><span itemprop="name">GAMES101-现代计算机图形学入门</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="GAMES101-Geometry-part3"><a href="#GAMES101-Geometry-part3" class="headerlink" title="GAMES101 Geometry part3"></a>GAMES101 Geometry part3</h1><ol>
<li>mesh subdivision 网格细化</li>
<li>mesh simplification 网格粗化</li>
<li>mesh regularization 网格正则化，使三角形趋于一致</li>
</ol>
<h2 id="Mesh-Subdivision"><a href="#Mesh-Subdivision" class="headerlink" title="Mesh Subdivision"></a>Mesh Subdivision</h2><p>两步操作：</p>
<ol>
<li>创建更多的三角形</li>
<li>移动这些三角形的位置</li>
</ol>
<h3 id="Loop-Subdivision-与循环无关，发明人叫Loop，仅适用于三角形网格"><a href="#Loop-Subdivision-与循环无关，发明人叫Loop，仅适用于三角形网格" class="headerlink" title="Loop Subdivision (与循环无关，发明人叫Loop，仅适用于三角形网格)"></a>Loop Subdivision (与循环无关，发明人叫Loop，仅适用于三角形网格)</h3><p>连接三角形三条边的中点，则原本的一个三角形转变为四个。</p>
<center><img src="/2022/02/25/GAMES101-Geometry-3/1.png" width="100%" height="100%"></center>

<p><strong>新顶点</strong>和<strong>原有顶点</strong>具有不同的更新策略。（区分为两类）</p>
<center><img src="/2022/02/25/GAMES101-Geometry-3/2.png" width="100%" height="100%"></center>

<p>其中新顶点的更新要考虑到新顶点所在边所对应的两个三角形。AB为新顶点所在边，被两个三角形共有。</p>
<center><img src="/2022/02/25/GAMES101-Geometry-3/3.png" width="100%" height="100%"></center>

<p>对于旧顶点，由于顶点是位于三角形顶点上的，因此会被多个三角形共有，其值的更新就要考虑到周围所有的三角形。n指顶点的度，也就是顶点所连接的边的数量，对应有多少个相邻顶点。u为一个与n有关的值。从公式看，除了相邻顶点，旧顶点值的更新还需用到自身的值，权重为(1-n*u)。而周围点权重为u*n，n体现在sum中。</p>
<h3 id="Catmull-Clark-Subdivision（General-Mesh，任意网格都适用）"><a href="#Catmull-Clark-Subdivision（General-Mesh，任意网格都适用）" class="headerlink" title="Catmull-Clark Subdivision（General Mesh，任意网格都适用）"></a>Catmull-Clark Subdivision（General Mesh，任意网格都适用）</h3><p>引入概念：<br>奇异点extraordinary vertex：度不为4的点（连接边数不为4）</p>
<center><img src="/2022/02/25/GAMES101-Geometry-3/4.png" width="100%" height="100%"></center>

<p>连接每个面的中点与每条边的中点。</p>
<center><img src="/2022/02/25/GAMES101-Geometry-3/5.png" width="100%" height="100%"></center>

<p>得到的新网格有两个特性。</p>
<ol>
<li>得到的所有面均为四边形面，所有的非四边形面全部消失。</li>
<li>原来的奇异点不变，其对应的度也不变。（连接面中点与边中点，与这个顶点无关）</li>
<li>新增加的奇异点的数量等于原来非四边形面的数量。（多边形每条边都与面中点相连，中点的度就等于多边形的边数）</li>
<li>由于做完一次Catmull-Clark Subdivision后，所有面均为四边形面。因此下一次再做Catmull-Clark Subdivision后，奇异点数量不变。</li>
</ol>
<center><img src="/2022/02/25/GAMES101-Geometry-3/6_1.png" width="50%" height="50%"><img src="/2022/02/25/GAMES101-Geometry-3/6_2.png" width="50%" height="50%"></center>

<p>细分之后点被分为三类，各自对应不同的update policy。<br>新点：1面中点、2边中点，3旧顶点。</p>
<center><img src="/2022/02/25/GAMES101-Geometry-3/7.png" width="100%" height="100%"></center>

<h2 id="Mesh-Simplification"><a href="#Mesh-Simplification" class="headerlink" title="Mesh Simplification"></a>Mesh Simplification</h2><ol>
<li>减少三角形的数量</li>
<li>保持整体形状</li>
</ol>
<h3 id="Edge-Collapse-边坍缩"><a href="#Edge-Collapse-边坍缩" class="headerlink" title="Edge Collapse 边坍缩"></a>Edge Collapse 边坍缩</h3><p>把一条边的两个顶点捏在一起，使一条边消失。</p>
<center><img src="/2022/02/25/GAMES101-Geometry-3/8.png" width="100%" height="100%"></center>

<p>两个问题：</p>
<ol>
<li>坍缩后的顶点应该取在哪？</li>
<li>应该坍缩网格中的哪些边？</li>
</ol>
<p>对于第一个问题，如果仅仅取坍缩边顶点的平均值，如图所示，显而易见的并不能很好地保留原先的形状。所以引入一个度量<br><strong>Quadric Error Metrics 二次误差度量</strong><br>到坍缩前相关的各个面的square distance (L2 distance)的和最小的点，作为新顶点。<br>square distance (L2 distance)：指欧几里德距离，直线距离。</p>
<center><img src="/2022/02/25/GAMES101-Geometry-3/9.png" width="100%" height="100%"></center>

<p>对于第二个问题，应该坍缩哪些边？<br>最终目的是尽可能地保持原有形状，那么就先对每条边，计算坍缩对应边之后，新顶点的Quadric Error Metrics二次误差度量。从小到大开始坍缩。<br>带来的新问题：每次坍缩会影响周围其他边的二次误差度量。-&gt;每次坍缩完一条边之后，更新受到影响的边的二次误差度量。<br>那么就需要一种数据结构，除了能提供当前极值之外，还得能动态地以最小代价修改任意元素（快速搜索，快速增删）。-&gt;堆（优先级队列）<br>这种做法得到的其实不是全局最优解，而是每一次都取<strong>局部最优解</strong>（每次坍缩当前二次误差度量最小的边），是一种<strong>贪心算法</strong>，能得到近似最优解。</p>
<blockquote>
<h4 id="优先级队列-priority-queue"><a href="#优先级队列-priority-queue" class="headerlink" title="优先级队列 priority queue"></a>优先级队列 priority queue</h4><p>最高优先级元素先出。</p>
<ol>
<li>非线性数据结构，由完全二叉树构造而成，完全二叉树可由一维数组实现。</li>
<li>堆中某个节点的值，总是不大于/不小于其父节点的值</li>
<li>大顶堆（根节点最大），小顶堆（根节点最小）</li>
</ol>
<p>由于堆是由完全二叉树构造而成，因此除了堆本身的性质（能快速提供最大值/最小值）之外，还具备二叉树的优点（二叉树具备了数组和链表的优点：快速查找，支持动态插入/删除）。</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/02/25/GAMES101-RayTracing-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Jiang Shao">
      <meta itemprop="description" content="WeChat: shaojiang9650<br>Email: shao_study@163.com">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="邵大宝的学习Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/02/25/GAMES101-RayTracing-1/" class="post-title-link" itemprop="url">GAMES101 RayTracing Part 1</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-02-25 16:44:37" itemprop="dateCreated datePublished" datetime="2022-02-25T16:44:37+08:00">2022-02-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-03-01 17:11:18" itemprop="dateModified" datetime="2022-03-01T17:11:18+08:00">2022-03-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/GAMES101-%E7%8E%B0%E4%BB%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6%E5%85%A5%E9%97%A8/" itemprop="url" rel="index"><span itemprop="name">GAMES101-现代计算机图形学入门</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="GAMES101-RayTracing-Part-1"><a href="#GAMES101-RayTracing-Part-1" class="headerlink" title="GAMES101 RayTracing Part 1"></a>GAMES101 RayTracing Part 1</h1><blockquote>
<p>为什么使用Ray Tracing?</p>
</blockquote>
<p>光栅化不能很好的处理全局效应。global effect</p>
<ul>
<li>(Soft) shadows 软阴影（边界模糊）<br>若光源是点光源，则产生的阴影是<strong>硬阴影</strong>，<strong>边界清晰</strong>。<br>若光源本身具有一定的大小，则产生的阴影是<strong>软阴影</strong>，<strong>边界模糊</strong>，原因是部份位置只能看到光源的一部分。</li>
<li>Glossy reflection 模糊反射<br>物体表面比较光滑，既有镜面反射，又有一定的漫反射。</li>
<li>Indirect illumination 间接光照<br>The light bounces more than once. 光线多次弹射。</li>
</ul>
<p>Rasterization is fast but quality is relatively low.<br>光栅化很快，但质量相对较低。通常用于实时real-time应用。</p>
<p>Ray tracing is accurate but is very slow.<br>光线追踪非常精确，但非常耗时。通常用于离线offline应用。</p>
<h2 id="Basic-Ray-Tracing-Algorithm"><a href="#Basic-Ray-Tracing-Algorithm" class="headerlink" title="Basic Ray-Tracing Algorithm"></a>Basic Ray-Tracing Algorithm</h2><p>对光线的三个假设：</p>
<ol>
<li>Light travels in straight lines (though this is wrong)<br>光线沿直线传播。</li>
<li>Light rays do not “collide” with each other if they cross (though this is still wrong)<br>光线之间不会发生碰撞，不会互相影响。</li>
<li>Light rays travel from the light sources to the eye (but the physics is invariant under path reversal - reciprocity).<br>光线从光源中发出，最终射入相机中。（可逆性，光路可逆，从相机到光源）</li>
</ol>
<p>Ray Casting 光线投射</p>
<ol>
<li>Generate an image by casting one ray per pixel<br>每个像素向场景中投射一条光线</li>
<li>Check for shadows by sending a ray to the light<br>检查投射光线打到的位置是不是处于阴影里（是不是对光源可见）</li>
</ol>
<p>检查最近交点（深度测试）</p>
<center><img src="/2022/02/25/GAMES101-RayTracing-1/1.png" width="100%"></center>

<p>检查是否对光源可见</p>
<center><img src="/2022/02/25/GAMES101-RayTracing-1/2.png" width="100%"></center>

<h2 id="Recursive-Whitted-Style-Ray-Tracing-递归光线追踪"><a href="#Recursive-Whitted-Style-Ray-Tracing-递归光线追踪" class="headerlink" title="Recursive (Whitted-Style) Ray Tracing 递归光线追踪"></a>Recursive (Whitted-Style) Ray Tracing 递归光线追踪</h2><p>在任意点，光线可以继续传播，而不是仅弹射一次、计算投射点的着色值。对于每个投射点，都用一条shadow ray判断是否处于阴影里并计算对应的着色值，最终像素的值等于所有投射点着色值的加权和。<br>对于光线进行一个简单的分类，第一次投射的光线为primary ray，经过一次弹射的光线为secondary ray，而从每个光线投射点连接到光源判断是否处于阴影的线为shadow ray。</p>
<center><img src="/2022/02/25/GAMES101-RayTracing-1/3.png" width="100%"></center>

<h2 id="Ray-Surface-Intersection"><a href="#Ray-Surface-Intersection" class="headerlink" title="Ray-Surface Intersection"></a>Ray-Surface Intersection</h2><p>ray光线 = origin起点 + direction vector方向矢量</p>
<center><img src="/2022/02/25/GAMES101-RayTracing-1/4.png" width="100%"></center>

<h3 id="光线与球的交点"><a href="#光线与球的交点" class="headerlink" title="光线与球的交点"></a>光线与球的交点</h3><p>球面方程：空间中点p到球心c的距离恰好等于球的半径R</p>
<center><img src="/2022/02/25/GAMES101-RayTracing-1/5.png" width="100%"></center>

<p>球面方程与光线方程联立求解t。使用求根公式</p>
<ol>
<li>首先由于光线是沿正向传播的，因此 t &gt; 0。</li>
<li>利用 b^2 - 4ac 判断解的个数，对应光线与球具有多少个交点。</li>
<li>若具有两个交点，则取最小的t，对应于最近的交点。<center><img src="/2022/02/25/GAMES101-RayTracing-1/6.png" width="100%"></center>

</li>
</ol>
<h3 id="光线与隐式表示的面的交点"><a href="#光线与隐式表示的面的交点" class="headerlink" title="光线与隐式表示的面的交点"></a>光线与隐式表示的面的交点</h3><p>将隐式方程与光线方程联立求根。</p>
<center><img src="/2022/02/25/GAMES101-RayTracing-1/7.png" width="100%"></center>

<h3 id="光线与显式表示的面的交点"><a href="#光线与显式表示的面的交点" class="headerlink" title="光线与显式表示的面的交点"></a>光线与显式表示的面的交点</h3><p>最常用的几何显式表示法：Triangle Mesh 三角形网络</p>
<h4 id="光线与三角形的交点"><a href="#光线与三角形的交点" class="headerlink" title="光线与三角形的交点"></a>光线与三角形的交点</h4><p><strong>传统算法</strong></p>
<ol>
<li>三角形总是处于一个平面内，那么就求得光线与三角形所在平面的交点</li>
<li>判断这个交点是否在三角形内部</li>
</ol>
<p>Plane is defined by normal vector and a point on plane.<br>平面可以被一条法线和空间中一个点（平面必须穿过这个点）所确定。</p>
<p>平面上所有的点与确定平面的点p’的连线一定与平面的法线垂直，点乘为0。则可以得到平面方程</p>
<center><img src="/2022/02/25/GAMES101-RayTracing-1/8.png" width="100%"></center>

<p>联立光线方程与平面方程求交点。求得的t必须为正，且为实数(b^2 - 4ac &gt;= 0)</p>
<center><img src="/2022/02/25/GAMES101-RayTracing-1/9.png" width="100%"></center>

<p><strong>Möller Trumbore Algorithm MT算法</strong></p>
<p>快速解法，平面方程直接使用三角形的质心坐标系，利用三角形的三个顶点线性组合得到的点所构成的平面。<br>只要三个顶点前的三个系数的和为1，则组合得到的点一定在三角形所在的平面上。<br>联立光线方程与平面方程，对t、b1、b2求解。<br>要求t为非负，且为实数。（光线为正向且有交点）<br>要求三个顶点前的系数(1-b1-b2)、b1、b2均为非负的。（交点在三角形内）</p>
<center><img src="/2022/02/25/GAMES101-RayTracing-1/10.png" width="100%"></center>

<h4 id="Accelerating-Ray-Surface-Intersection"><a href="#Accelerating-Ray-Surface-Intersection" class="headerlink" title="Accelerating Ray-Surface Intersection"></a>Accelerating Ray-Surface Intersection</h4><p>如何判断光线与物体的那个三角形网格相交？</p>
<p>最简单的办法，遍历物体的所有三角形网格。-&gt; 非常耗时</p>
<p><strong>Bounding Volumes/Box 包围盒</strong><br>Understanding: box is the intersection of 3 pairs of slabs.<br>将包围盒（长方体）理解为三对平行平板所围成的区域。</p>
<p><strong>Axis-Aligned Bounding Box</strong> (AABB) (轴对⻬包围盒)<br>指长方体包围盒的每条边都与坐标轴平行</p>
<p><strong>判断光线与包围盒求交</strong></p>
<p>光线进入包围盒中 -&gt; 光线进入所有围成包围盒的对面中<br><strong>max(tmin)</strong> -&gt; 光线进入最后一个还没进入的对面的时间（之后就进入了所有对面）<br><strong>min(tmax)</strong> -&gt; 光线从任意一个对面出来的时间（从一个对面中出来则就不再处于包围盒内部）</p>
<center><img src="/2022/02/25/GAMES101-RayTracing-1/11.png" width="100%"></center>

<p>首先求光线与<strong>每对平行平板</strong>的交点，求出对应的tmin与tmax，组成一个区间。最后求这些区间的交集（代表光线处于所有对面内部）。</p>
<p><strong>Key ideas</strong></p>
<ul>
<li>The ray enters the box only when it enters all pairs of slabs 进入所有对面才进入包围盒</li>
<li>The ray exits the box as long as it exits any pair of slabs 离开任意一个对面则离开了包围盒</li>
</ul>
<center><img src="/2022/02/25/GAMES101-RayTracing-1/12.png" width="100%"></center>

<p>同上，每对面求个t区间，之后求交集。<br>如果<strong>tenter &lt; texit</strong>那么说明光线在包围盒中存在了一段时间，光线与包围盒一定有交点。</p>
<p><strong>各种特殊情况</strong><br>在<strong>tenter &lt; texit</strong>的前提下：</p>
<ol>
<li>texit &lt; 0<br>包围盒在光线的反方向 -&gt; 没有交点</li>
<li>texit &gt;= 0 &amp;&amp; tenter &lt; 0<br>进入交点在光线反方向，离开交点在正方向 -&gt; 光线起点在包围盒内部，有交点</li>
</ol>
<p>综上，光线与包围盒有交点，当且仅当</p>
<center><img src="/2022/02/25/GAMES101-RayTracing-1/13.png" width="100%"></center>

<center><img src="/2022/02/25/GAMES101-RayTracing-1/14.png" width="100%"></center>

<p>包围盒边与坐标轴对齐的好处：<br>求光线与一般平面交点公式如下。而当这个平面与x-axis垂直时，此时有平面法线N = (1, 0)，代入公式可化简计算。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/02/23/cuda-6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Jiang Shao">
      <meta itemprop="description" content="WeChat: shaojiang9650<br>Email: shao_study@163.com">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="邵大宝的学习Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/02/23/cuda-6/" class="post-title-link" itemprop="url">CUDA学习随记6 Asynchronous Barrier</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-02-23 21:41:50" itemprop="dateCreated datePublished" datetime="2022-02-23T21:41:50+08:00">2022-02-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-06-28 22:19:55" itemprop="dateModified" datetime="2022-06-28T22:19:55+08:00">2022-06-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CUDA%E5%AD%A6%E4%B9%A0%E9%9A%8F%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">CUDA学习随记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>原子操作中的内存顺序std::memory_order与CUDA中的异步barrier</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2022/02/23/cuda-6/">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Jiang Shao"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Jiang Shao</p>
  <div class="site-description" itemprop="description">WeChat: shaojiang9650<br>Email: shao_study@163.com</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">18</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jiang Shao</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
